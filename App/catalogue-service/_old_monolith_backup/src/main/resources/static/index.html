<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogue Service - API Test Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }

        .tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background: #f8f9fa;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            color: #495057;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e9ecef;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .response {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #667eea;
            max-height: 400px;
            overflow-y: auto;
        }

        .response h3 {
            margin-bottom: 10px;
            color: #495057;
        }

        .response pre {
            background: #212529;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .item-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .item-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }

        .item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .item-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .item-card p {
            margin: 5px 0;
            color: #495057;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 5px;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-danger {
            background: #dc3545;
            color: white;
        }

        .badge-info {
            background: #17a2b8;
            color: white;
        }

        .order-item {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .api-info {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .api-info h3 {
            color: #2196F3;
            margin-bottom: 10px;
        }

        .api-info ul {
            margin-left: 20px;
        }

        .api-info li {
            margin: 5px 0;
            color: #495057;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõí Catalogue Service API</h1>
            <p>Interactive REST API Testing Dashboard</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="openTab('categories')">üìÅ Categories</button>
            <button class="tab" onclick="openTab('products')">üì¶ Products</button>
            <button class="tab" onclick="openTab('orders')">üõçÔ∏è Orders</button>
            <button class="tab" onclick="openTab('api-docs')">üìñ API Docs</button>
        </div>

        <!-- Categories Tab -->
        <div id="categories" class="tab-content active">
            <div class="api-info">
                <h3>Categories Management</h3>
                <p>Manage product categories for your catalogue</p>
            </div>

            <h2>Create Category</h2>
            <div class="form-group">
                <label>Category Name</label>
                <input type="text" id="categoryName" placeholder="e.g., Electronics, Clothing">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="categoryDescription" rows="3" placeholder="Category description..."></textarea>
            </div>
            <button class="btn btn-primary" onclick="createCategory()">Create Category</button>
            <button class="btn btn-info" onclick="getAllCategories()">Get All Categories</button>

            <div id="categoryResponse" class="response" style="display:none;">
                <h3>Response:</h3>
                <pre id="categoryResponseContent"></pre>
            </div>

            <div id="categoryList" class="item-list"></div>
        </div>

        <!-- Products Tab -->
        <div id="products" class="tab-content">
            <div class="api-info">
                <h3>Products Management</h3>
                <p>Manage products in your catalogue with pricing and stock information</p>
            </div>

            <h2>Create Product</h2>
            <div class="form-group">
                <label>Product Name</label>
                <input type="text" id="productName" placeholder="e.g., Laptop HP">
            </div>
            <div class="form-group">
                <label>Description</label>
                <textarea id="productDescription" rows="3" placeholder="Product description..."></textarea>
            </div>
            <div class="form-group">
                <label>Price (‚Ç¨)</label>
                <input type="number" id="productPrice" step="0.01" placeholder="0.00">
            </div>
            <div class="form-group">
                <label>Stock Quantity</label>
                <input type="number" id="productStock" placeholder="0">
            </div>
            <div class="form-group">
                <label>Image URL</label>
                <input type="text" id="productImage" placeholder="https://...">
            </div>
            <div class="form-group">
                <label>Category ID</label>
                <input type="number" id="productCategoryId" placeholder="1">
            </div>
            <button class="btn btn-primary" onclick="createProduct()">Create Product</button>
            <button class="btn btn-info" onclick="getAllProducts()">Get All Products</button>
            <button class="btn btn-success" onclick="getAvailableProducts()">Get Available Products</button>

            <div id="productResponse" class="response" style="display:none;">
                <h3>Response:</h3>
                <pre id="productResponseContent"></pre>
            </div>

            <div id="productList" class="item-list"></div>
        </div>

        <!-- Orders Tab -->
        <div id="orders" class="tab-content">
            <div class="api-info">
                <h3>Orders Management</h3>
                <p>Create and manage customer orders</p>
            </div>

            <h2>Create Order</h2>
            <div class="form-group">
                <label>Client Email</label>
                <input type="email" id="orderEmail" placeholder="client@example.com">
            </div>
            <div class="form-group">
                <label>First Name</label>
                <input type="text" id="orderFirstName" placeholder="John">
            </div>
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" id="orderLastName" placeholder="Doe">
            </div>
            <div class="form-group">
                <label>Phone</label>
                <input type="text" id="orderPhone" placeholder="+33 6 12 34 56 78">
            </div>
            <div class="form-group">
                <label>Delivery Address</label>
                <textarea id="orderAddress" rows="2" placeholder="123 Main Street, Paris, 75001"></textarea>
            </div>
            <div class="form-group">
                <label>Product ID</label>
                <input type="number" id="orderProductId" placeholder="1">
            </div>
            <div class="form-group">
                <label>Quantity</label>
                <input type="number" id="orderQuantity" placeholder="1" value="1">
            </div>
            <button class="btn btn-primary" onclick="createOrder()">Create Order</button>
            <button class="btn btn-info" onclick="getAllOrders()">Get All Orders</button>

            <div id="orderResponse" class="response" style="display:none;">
                <h3>Response:</h3>
                <pre id="orderResponseContent"></pre>
            </div>

            <div id="orderList" class="item-list"></div>
        </div>

        <!-- API Documentation Tab -->
        <div id="api-docs" class="tab-content">
            <div class="api-info">
                <h3>üìñ API Documentation</h3>
                <p>Complete REST API endpoints for the Catalogue Service</p>
            </div>

            <h2>Base URL</h2>
            <pre style="background: #212529; color: #00ff00; padding: 15px; border-radius: 5px;">http://localhost:8082</pre>

            <h2>Categories Endpoints</h2>
            <ul>
                <li><strong>GET</strong> /api/categories - Get all categories</li>
                <li><strong>GET</strong> /api/categories/{id} - Get category by ID</li>
                <li><strong>POST</strong> /api/categories - Create new category</li>
                <li><strong>PUT</strong> /api/categories/{id} - Update category</li>
                <li><strong>DELETE</strong> /api/categories/{id} - Delete category</li>
                <li><strong>GET</strong> /api/categories/search?nom={name} - Search by name</li>
            </ul>

            <h2>Products Endpoints</h2>
            <ul>
                <li><strong>GET</strong> /api/products - Get all products</li>
                <li><strong>GET</strong> /api/products/{id} - Get product by ID</li>
                <li><strong>POST</strong> /api/products - Create new product</li>
                <li><strong>PUT</strong> /api/products/{id} - Update product</li>
                <li><strong>DELETE</strong> /api/products/{id} - Delete product</li>
                <li><strong>GET</strong> /api/products/category/{categoryId} - Get products by category</li>
                <li><strong>GET</strong> /api/products/available - Get available products</li>
                <li><strong>GET</strong> /api/products/search?keyword={keyword} - Search products</li>
                <li><strong>GET</strong> /api/products/price-range?minPrix={min}&maxPrix={max} - Filter by price</li>
                <li><strong>PATCH</strong> /api/products/{id}/stock?quantity={qty} - Update stock</li>
            </ul>

            <h2>Orders Endpoints</h2>
            <ul>
                <li><strong>GET</strong> /api/orders - Get all orders</li>
                <li><strong>GET</strong> /api/orders/{id} - Get order by ID</li>
                <li><strong>POST</strong> /api/orders - Create new order</li>
                <li><strong>PUT</strong> /api/orders/{id} - Update order</li>
                <li><strong>DELETE</strong> /api/orders/{id} - Delete order</li>
                <li><strong>GET</strong> /api/orders/number/{orderNumber} - Get order by number</li>
                <li><strong>GET</strong> /api/orders/client?email={email} - Get orders by client</li>
                <li><strong>GET</strong> /api/orders/status/{status} - Get orders by status</li>
                <li><strong>PATCH</strong> /api/orders/{id}/status?status={status} - Update order status</li>
            </ul>

            <h2>Actuator Endpoints</h2>
            <ul>
                <li><strong>GET</strong> /actuator/health - Application health check</li>
                <li><strong>GET</strong> /actuator/info - Application info</li>
                <li><strong>GET</strong> /actuator/metrics - Application metrics</li>
            </ul>

            <h2>H2 Database Console</h2>
            <p>Access the H2 database console at: <a href="http://localhost:8082/h2-console" target="_blank">http://localhost:8082/h2-console</a></p>
            <ul>
                <li><strong>JDBC URL:</strong> jdbc:h2:mem:catalogue_db</li>
                <li><strong>Username:</strong> sa</li>
                <li><strong>Password:</strong> (leave empty)</li>
            </ul>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:8082/api';

        function openTab(tabName) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => tab.classList.remove('active'));
            contents.forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function showResponse(elementId, data) {
            const responseDiv = document.getElementById(elementId);
            const responseContent = document.getElementById(elementId + 'Content');
            responseContent.textContent = JSON.stringify(data, null, 2);
            responseDiv.style.display = 'block';
        }

        // Categories Functions
        async function createCategory() {
            const name = document.getElementById('categoryName').value;
            const description = document.getElementById('categoryDescription').value;

            if (!name) {
                alert('Please enter a category name');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/categories`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ nom: name, description })
                });

                const data = await response.json();
                showResponse('categoryResponse', data);

                if (response.ok) {
                    document.getElementById('categoryName').value = '';
                    document.getElementById('categoryDescription').value = '';
                    getAllCategories();
                }
            } catch (error) {
                showResponse('categoryResponse', { error: error.message });
            }
        }

        async function getAllCategories() {
            try {
                const response = await fetch(`${API_BASE_URL}/categories`);
                const data = await response.json();
                showResponse('categoryResponse', data);
                displayCategories(data);
            } catch (error) {
                showResponse('categoryResponse', { error: error.message });
            }
        }

        function displayCategories(categories) {
            const listDiv = document.getElementById('categoryList');
            listDiv.innerHTML = '';

            categories.forEach(category => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.innerHTML = `
                    <h4>üìÅ ${category.nom}</h4>
                    <p><strong>ID:</strong> ${category.id}</p>
                    <p><strong>Description:</strong> ${category.description || 'N/A'}</p>
                    <p><strong>Created:</strong> ${new Date(category.createdAt).toLocaleString()}</p>
                `;
                listDiv.appendChild(card);
            });
        }

        // Products Functions
        async function createProduct() {
            const name = document.getElementById('productName').value;
            const description = document.getElementById('productDescription').value;
            const prix = parseFloat(document.getElementById('productPrice').value);
            const stockQuantity = parseInt(document.getElementById('productStock').value);
            const imageUrl = document.getElementById('productImage').value;
            const categoryId = parseInt(document.getElementById('productCategoryId').value);

            if (!name || !prix || !stockQuantity || !categoryId) {
                alert('Please fill in all required fields');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/products`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nom: name,
                        description,
                        prix,
                        stockQuantity,
                        imageUrl,
                        categoryId,
                        disponible: true
                    })
                });

                const data = await response.json();
                showResponse('productResponse', data);

                if (response.ok) {
                    document.getElementById('productName').value = '';
                    document.getElementById('productDescription').value = '';
                    document.getElementById('productPrice').value = '';
                    document.getElementById('productStock').value = '';
                    document.getElementById('productImage').value = '';
                    getAllProducts();
                }
            } catch (error) {
                showResponse('productResponse', { error: error.message });
            }
        }

        async function getAllProducts() {
            try {
                const response = await fetch(`${API_BASE_URL}/products`);
                const data = await response.json();
                showResponse('productResponse', data);
                displayProducts(data);
            } catch (error) {
                showResponse('productResponse', { error: error.message });
            }
        }

        async function getAvailableProducts() {
            try {
                const response = await fetch(`${API_BASE_URL}/products/available`);
                const data = await response.json();
                showResponse('productResponse', data);
                displayProducts(data);
            } catch (error) {
                showResponse('productResponse', { error: error.message });
            }
        }

        function displayProducts(products) {
            const listDiv = document.getElementById('productList');
            listDiv.innerHTML = '';

            products.forEach(product => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.innerHTML = `
                    <h4>üì¶ ${product.nom}</h4>
                    <p><strong>ID:</strong> ${product.id}</p>
                    <p><strong>Price:</strong> ‚Ç¨${product.prix}</p>
                    <p><strong>Stock:</strong> ${product.stockQuantity}</p>
                    <p><strong>Category:</strong> ${product.categoryNom}</p>
                    <span class="badge ${product.disponible ? 'badge-success' : 'badge-danger'}">
                        ${product.disponible ? 'Available' : 'Out of Stock'}
                    </span>
                `;
                listDiv.appendChild(card);
            });
        }

        // Orders Functions
        async function createOrder() {
            const clientEmail = document.getElementById('orderEmail').value;
            const clientPrenom = document.getElementById('orderFirstName').value;
            const clientNom = document.getElementById('orderLastName').value;
            const clientTelephone = document.getElementById('orderPhone').value;
            const adresseLivraison = document.getElementById('orderAddress').value;
            const productId = parseInt(document.getElementById('orderProductId').value);
            const quantity = parseInt(document.getElementById('orderQuantity').value);

            if (!clientEmail || !clientPrenom || !clientNom || !adresseLivraison || !productId || !quantity) {
                alert('Please fill in all required fields');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/orders`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        clientEmail,
                        clientNom,
                        clientPrenom,
                        clientTelephone,
                        adresseLivraison,
                        orderItems: [{
                            productId,
                            quantity
                        }]
                    })
                });

                const data = await response.json();
                showResponse('orderResponse', data);

                if (response.ok) {
                    document.getElementById('orderEmail').value = '';
                    document.getElementById('orderFirstName').value = '';
                    document.getElementById('orderLastName').value = '';
                    document.getElementById('orderPhone').value = '';
                    document.getElementById('orderAddress').value = '';
                    document.getElementById('orderProductId').value = '';
                    document.getElementById('orderQuantity').value = '1';
                    getAllOrders();
                }
            } catch (error) {
                showResponse('orderResponse', { error: error.message });
            }
        }

        async function getAllOrders() {
            try {
                const response = await fetch(`${API_BASE_URL}/orders`);
                const data = await response.json();
                showResponse('orderResponse', data);
                displayOrders(data);
            } catch (error) {
                showResponse('orderResponse', { error: error.message });
            }
        }

        function displayOrders(orders) {
            const listDiv = document.getElementById('orderList');
            listDiv.innerHTML = '';

            orders.forEach(order => {
                const card = document.createElement('div');
                card.className = 'item-card';

                let itemsHtml = '';
                order.orderItems.forEach(item => {
                    itemsHtml += `
                        <div class="order-item">
                            <strong>${item.productNom}</strong> - Qty: ${item.quantity} - ‚Ç¨${item.sousTotal}
                        </div>
                    `;
                });

                card.innerHTML = `
                    <h4>üõçÔ∏è Order #${order.orderNumber}</h4>
                    <p><strong>Customer:</strong> ${order.clientPrenom} ${order.clientNom}</p>
                    <p><strong>Email:</strong> ${order.clientEmail}</p>
                    <p><strong>Total:</strong> ‚Ç¨${order.montantTotal}</p>
                    <span class="badge badge-info">${order.status}</span>
                    <div style="margin-top: 10px;">
                        <strong>Items:</strong>
                        ${itemsHtml}
                    </div>
                `;
                listDiv.appendChild(card);
            });
        }

        // Load initial data
        window.onload = function() {
            getAllCategories();
        };
    </script>
</body>
</html>

